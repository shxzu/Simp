package cc.simp.modules.impl.exploit;

import cc.simp.event.impl.player.PreUpdateEvent;
import cc.simp.modules.Module;
import cc.simp.modules.ModuleCategory;
import cc.simp.modules.ModuleInfo;
import io.github.nevalackin.homoBus.Listener;
import io.github.nevalackin.homoBus.annotations.EventLink;
import net.minecraft.client.gui.GuiChat;
import net.minecraft.client.settings.GameSettings;
import net.minecraft.client.settings.KeyBinding;
import org.lwjgl.input.Keyboard;

import static cc.simp.utils.Util.mc;

@ModuleInfo(label = "Inventory Movement", category = ModuleCategory.EXPLOIT)
public class InventoryMovementModule extends Module {

	KeyBinding[] moveKeys = new KeyBinding[]{mc.gameSettings.keyBindForward, mc.gameSettings.keyBindBack, mc.gameSettings.keyBindLeft, mc.gameSettings.keyBindRight, mc.gameSettings.keyBindJump};;

	@EventLink
	private final Listener<PreUpdateEvent> preUpdateEventListener = event -> {
		if (!(mc.currentScreen instanceof GuiChat)) {
			KeyBinding[] keyBindingArray = this.moveKeys;
			int n = this.moveKeys.length;
			int n2 = 0;
			while (n2 < n) {
				KeyBinding bind = keyBindingArray[n2];
				KeyBinding.setKeyBindState(bind.getKeyCode(), Keyboard.isKeyDown((int)bind.getKeyCode()));
				++n2;
			}
		}
	};

	@Override
	public void onDisable() {
		if (!GameSettings.isKeyDown(mc.gameSettings.keyBindForward) || mc.currentScreen != null) {
			mc.gameSettings.keyBindForward.setPressed(false);
		}
		if (!GameSettings.isKeyDown(mc.gameSettings.keyBindBack) || mc.currentScreen != null) {
			mc.gameSettings.keyBindBack.setPressed(false);
		}
		if (!GameSettings.isKeyDown(mc.gameSettings.keyBindRight) || mc.currentScreen != null) {
			mc.gameSettings.keyBindRight.setPressed(false);
		}
		if (!GameSettings.isKeyDown(mc.gameSettings.keyBindLeft) || mc.currentScreen != null) {
			mc.gameSettings.keyBindLeft.setPressed(false);
		}
		if (!GameSettings.isKeyDown(mc.gameSettings.keyBindJump) || mc.currentScreen != null) {
			mc.gameSettings.keyBindJump.setPressed(false);
		}
		if (!GameSettings.isKeyDown(mc.gameSettings.keyBindSprint) || mc.currentScreen != null) {
			mc.gameSettings.keyBindSprint.setPressed(false);
		}
		super.onDisable();
	}
}
